<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Statistics: chi2gof</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous"></script>
    <script type="text/javascript" async
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
    </script>
    <style>
    var {
      font-style: italics;
      font-weight: bold;
    }
    td {
      vertical-align: top;
    }
    </style>
  </head>
  <body>
    <div class="bg-dark">
      <div class="container-xl">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
          <div class="container-fluid">
            <a class="navbar-brand" href=index.html>
              <img src="assets/statistics.png" alt="statistics" class="d-inline-block align-top" width="25" height="25">
              Statistics
            </a>
            <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
              <ul class="navbar-nav">
                <li class="nav-item">
                  <a class="nav-link" href="index.html#Hypothesis Testing">
                    <i class="fas fa-list-alt"></i>
                    Hypothesis Testing
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="https://gnu-octave.github.io/packages/">
                  <img src="assets/octave-logo.svg" alt="GNU Octave logo" class="d-inline-block align-top" width="25" height="25">
                    Octave Packages
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="https://www.octave.org">
                    <i class="fas fa-home"></i>
                    GNU Octave website
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </nav>
      </div>
    </div>
    <div class="container-xl my-4">
      <div class="card rounded">
        <div class="card-header card-header-mod">
          <div class="row d-flex flex-wrap align-items-center">
            <div class="col-sm-3 col-md-5 mb-2 mb-sm-0">
              <h3 class="d-inline-block mr-2">
              Function&nbsp;Reference: <b><code>chi2gof</code></b>
              </h3>
            </div>
          </div>
        </div>
        <div class="card-body">
<dl>
<dt><u>statistics:</u> <var>h</var> = <b>chi2gof</b><i> (<var>x</var>)</i></dt>
<dt><u>statistics:</u> [<var>h</var>, <var>p</var>] = <b>chi2gof</b><i> (<var>x</var>)</i></dt>
<dt><u>statistics:</u> [<var>p</var>, <var>h</var>, <var>stats</var>] = <b>chi2gof</b><i> (<var>x</var>)</i></dt>
<dt><u>statistics:</u> [&hellip;] = <b>chi2gof</b><i> (<var>x</var>, <var>Name</var>, <var>Value</var>, &hellip;)</i></dt>
</dl>

<p> Chi-square goodness-of-fit test.
</p>
<div class="ms-5">
<p> <code>chi2gof</code> performs a chi-square goodness-of-fit test for discrete or
 continuous distributions.  The test is performed by grouping the data into
 bins, calculating the observed and expected counts for those bins, and
 computing the chi-square test statistic
 $$ \chi ^ 2 = \sum_{i=1}^N \left (O_i - E_i \right) ^ 2 / E_i $$
  where O is the observed counts and E is the expected counts.  This test
 statistic has an approximate chi-square distribution when the counts are
 sufficiently large.
</p>
<p> Bins in either tail with an expected count less than 5 are pooled with
 neighboring bins until the count in each extreme bin is at least 5.  If
 bins remain in the interior with counts less than 5, <code>chi2gof</code> displays
 a warning.  In that case, you should use fewer bins, or provide bin centers
 or binedges, to increase the expected counts in all bins.
</p>
<p> <code><var>h</var> = chi2gof (<var>x</var>)</code> performs a chi-square goodness-of-fit test
 that the data in the vector X are a random sample from a normal distribution
 with mean and variance estimated from <var>x</var>.  The result is <var>h</var> = 0 if
 the null hypothesis (that <var>x</var> is a random sample from a normal
 distribution) cannot be rejected at the 5% significance level, or <var>h</var> = 1
 if the nullhypothesis can be rejected at the 5% level.  <code>chi2gof</code> uses
 by default 10 bins (<code>&quot;nbins&quot;</code>), and compares the test statistic to a
 chi-square distribution with <code><var>nbins</var> - 3</code> degrees of freedom, to
 take into account that two parameters were estimated.
</p>
<p> <code>[<var>h</var>, <var>p</var>] = chi2gof (<var>x</var>)</code> also returns the p-value <var>p</var>,
 which is the probability of observing the given result, or one more extreme,
 by chance if the null hypothesis is true.  If there are not enough degrees of
 freedom to carry out the test, <var>p</var> is NaN.
</p>
<p> <code>[<var>h</var>, <var>p</var>, <var>stats</var>] = chi2gof (<var>x</var>)</code> also returns a
 <var>stats</var> structure with the following fields:
</p>
 <table>
<tr><td width="5%"></td><td width="30%">&quot;chi2stat&quot;</td><td width="65%">Chi-square statistic</td></tr>
<tr><td width="5%"></td><td width="30%">&quot;df&quot;</td><td width="65%">Degrees of freedom</td></tr>
<tr><td width="5%"></td><td width="30%">&quot;binedges&quot;</td><td width="65%">Vector of bin binedges after pooling</td></tr>
<tr><td width="5%"></td><td width="30%">&quot;O&quot;</td><td width="65%">Observed count in each bin</td></tr>
<tr><td width="5%"></td><td width="30%">&quot;E&quot;</td><td width="65%">Expected count in each bin</td></tr>
</table>

<p> <code>[&hellip;] = chi2gof (<var>x</var>, <var>Name</var>, <var>Value</var>, &hellip;)</code>
 specifies optional Name/Value pair arguments chosen from the following list.
</p>
 <table>
<thead><tr><th width="5%"></th><th width="20%">Name</th><th width="75%">Value</th></tr></thead>
<tr><td width="5%"></td><td width="20%"><code>&quot;nbins&quot;</code></td><td width="75%">The number of bins to use.  Default is 10.</td></tr>
<tr><td width="5%"></td><td width="20%"><code>&quot;binctrs&quot;</code></td><td width="75%">A vector of bin centers.</td></tr>
<tr><td width="5%"></td><td width="20%"><code>&quot;binedges&quot;</code></td><td width="75%">A vector of bin binedges.</td></tr>
<tr><td width="5%"></td><td width="20%"><code>&quot;cdf&quot;</code></td><td width="75%">A fully specified cumulative distribution
 function or a function handle provided in a cell array whose first element is
 a function handle, and all later elements are its parameter values.  The
 function must take <var>x</var> values as its first argument, and other parameters
 as later arguments.</td></tr>
<tr><td width="5%"></td><td width="20%"><code>&quot;expected&quot;</code></td><td width="75%">A vector with one element per bin
 specifying the expected counts for each bin.</td></tr>
<tr><td width="5%"></td><td width="20%"><code>&quot;nparams&quot;</code></td><td width="75%">The number of estimated parameters; used to
 adjust the degrees of freedom to be <code><var>nbins</var> - 1 - <var>nparams</var></code>,
 where <var>nbins</var> is the number of bins.</td></tr>
<tr><td width="5%"></td><td width="20%"><code>&quot;emin&quot;</code></td><td width="75%">The minimum allowed expected value for a bin;
 any bin in either tail having an expected value less than this amount is
 pooled with a neighboring bin.  Use the value 0 to prevent pooling.  Default
 is 5.</td></tr>
<tr><td width="5%"></td><td width="20%"><code>&quot;frequency&quot;</code></td><td width="75%">A vector of the same length as <var>x</var>
 containing the frequency of the corresponding <var>x</var> values.</td></tr>
<tr><td width="5%"></td><td width="20%"><code>&quot;alpha&quot;</code></td><td width="75%">An <var>alpha</var> value such that the hypothesis
 is rejected if <code><var>p</var> &lt; <var>alpha</var></code>.  Default is
 <code><var>alpha</var> = 0.05</code>.</td></tr>
</table>

<p> You should specify either <code>&quot;cdf&quot;</code> or <code>&quot;expected&quot;</code> parameters, but
 not both.  If your <code>&quot;cdf&quot;</code> input contains extra parameters, these are
 accounted for automatically and there is no need to specify <code>&quot;nparams&quot;</code>.
 If your <code>&quot;expected&quot;</code> input depends on estimated parameters, you should
 use the <code>&quot;nparams&quot;</code> parameter to ensure that the degrees of freedom for
 the test is correct.
</p>

<p><strong>Source Code: </strong>
  <a href="https://github.com/gnu-octave/statistics/tree/main/inst/chi2gof.m">chi2gof</a>
</div>

        <div class="container-xl my-4">
          <div class="card rounded">
            <div class="card-header card-header-mod">
              <div class="row d-flex flex-wrap align-items-center">
                <div class="col-sm-3 col-md-5 mb-2 mb-sm-0">
                  <h3 class="d-inline-block mr-2">
                  Example: 1
                  </h3>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="container bg-light">
                <div class="row">
                  <table><tbody><tr>
                    <td>&nbsp;</td>
                    <td><pre class="example">

 x = normrnd (50, 5, 100, 1);
 [h, p, stats] = chi2gof (x)
 [h, p, stats] = chi2gof (x, "cdf", @(x)normcdf (x, mean(x), std(x)))
 [h, p, stats] = chi2gof (x, "cdf", {@normcdf, mean(x), std(x)})

h = 0
p = 0.5464
stats =

  scalar structure containing the fields:

    chi2stat = 4.0212
    df = 5
    edges =

       38.399   42.726   44.890   47.053   49.217   51.380   53.544   55.708   60.035

    O =

        9    7    9   22   17   14   10   12

    E =

        6.8588    8.2228   13.0313   16.8721   17.8471   15.4236   10.8899   10.8544


h = 0
p = 0.5464
stats =

  scalar structure containing the fields:

    chi2stat = 4.0212
    df = 5
    edges =

       38.399   42.726   44.890   47.053   49.217   51.380   53.544   55.708   60.035

    O =

        9    7    9   22   17   14   10   12

    E =

        6.8588    8.2228   13.0313   16.8721   17.8471   15.4236   10.8899   10.8544


h = 0
p = 0.5464
stats =

  scalar structure containing the fields:

    chi2stat = 4.0212
    df = 5
    edges =

       38.399   42.726   44.890   47.053   49.217   51.380   53.544   55.708   60.035

    O =

        9    7    9   22   17   14   10   12

    E =

        6.8588    8.2228   13.0313   16.8721   17.8471   15.4236   10.8899   10.8544


                    </pre></td></tr></tbody>
                  </table>

                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="container-xl my-4">
          <div class="card rounded">
            <div class="card-header card-header-mod">
              <div class="row d-flex flex-wrap align-items-center">
                <div class="col-sm-3 col-md-5 mb-2 mb-sm-0">
                  <h3 class="d-inline-block mr-2">
                  Example: 2
                  </h3>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="container bg-light">
                <div class="row">
                  <table><tbody><tr>
                    <td>&nbsp;</td>
                    <td><pre class="example">

 x = rand (100,1 );
 n = length (x);
 binedges = linspace (0, 1, 11);
 expectedCounts = n * diff (binedges);
 [h, p, stats] = chi2gof (x, "binedges", binedges, "expected", expectedCounts)

h = 0
p = 0.9835
stats =

  scalar structure containing the fields:

    chi2stat = 2.4000
    df = 9
    edges =

     Columns 1 through 6:

       4.2756e-03   1.0230e-01   2.0032e-01   2.9835e-01   3.9637e-01   4.9439e-01

     Columns 7 through 11:

       5.9242e-01   6.9044e-01   7.8847e-01   8.8649e-01   9.8451e-01

    O =

       10    9   12    9    8   10   11    8   10   13

    E =

       10   10   10   10   10   10   10   10   10   10


                    </pre></td></tr></tbody>
                  </table>

                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="container-xl my-4">
          <div class="card rounded">
            <div class="card-header card-header-mod">
              <div class="row d-flex flex-wrap align-items-center">
                <div class="col-sm-3 col-md-5 mb-2 mb-sm-0">
                  <h3 class="d-inline-block mr-2">
                  Example: 3
                  </h3>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="container bg-light">
                <div class="row">
                  <table><tbody><tr>
                    <td>&nbsp;</td>
                    <td><pre class="example">

 bins = 0:5;
 obsCounts = [6 16 10 12 4 2];
 n = sum(obsCounts);
 lambdaHat = sum(bins.*obsCounts) / n;
 expCounts = n * poisspdf(bins,lambdaHat);
 [h, p, stats] = chi2gof (bins, "binctrs", bins, "frequency", obsCounts, ...
                          "expected", expCounts, "nparams",1)

h = 0
p = 0.4654
stats =

  scalar structure containing the fields:

    chi2stat = 2.5550
    df = 3
    edges =

       4.9407e-324    8.3333e-01    1.6667e+00    2.5000e+00    3.3333e+00    5.0000e+00

    O =

        6   16   10   12    6

    E =

        7.0429   13.8041   13.5280    8.8383    6.0284


                    </pre></td></tr></tbody>
                  </table>

                </div>
              </div>
            </div>
          </div>
        </div>


        </div>
      </div>
    </div>

  </body>
</html>
